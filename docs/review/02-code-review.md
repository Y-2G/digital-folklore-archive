# コードレビューでの重大観点（事故を防ぐチェック項目）

## 正しさ（Correctness）

- 仕様通りか？（特に境界・例外系）
- 状態遷移が破綻してないか（多重実行、並行更新、二重送信）
- 時刻・タイムゾーン・丸め・通貨/数値の扱い

## 安全性（Security / Privacy）

- 認可が抜けてないか（IDを渡せば見える/更新できる系）
- 入力バリデーション、SQL/OSコマンド/テンプレ注入、XSS/CSRF
- ログに個人情報やトークンを出してないか
- 依存ライブラリの危険な使い方（例：shell=true 的なやつ、危険なデシリアライズ）

## データ整合性（Integrity）

- 途中失敗で"中途半端な状態"が残らないか
- トランザクション境界は適切か
- ユニーク制約や参照整合性をアプリ側のifだけに頼ってないか

## 冪等性・再試行耐性（Resilience）

- リトライで二重に作られない/二重に課金されない/二重に送信されない
- 外部I/Oのタイムアウト・キャンセル・再実行が安全か
- "一回だけ起きてほしい"処理に、確実なガードがあるか

## 性能（Performance）

- クエリ数、インデックス、検索条件、ページング
- ループ内I/O、巨大配列の組み立て、不要な再レンダリング（フロント）
- 直列処理を並列にできないか、逆に並列が暴走してないか

## 可観測性・運用（Observability）

- 失敗時に原因が追えるログ/メトリクスがあるか
- エラーメッセージが利用者/運用者にとって意味があるか
- アラート閾値・サーキットブレーカ的な防御が必要な箇所は？

## 変更容易性（Maintainability）

- 責務の分離（ドメイン/ユースケース/インフラ、UI/状態/副作用）
- 命名が仕様を表しているか（ドメイン語が出てるか）
- "一見便利な共通化"が将来の改修を難しくしてないか
